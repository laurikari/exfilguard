# ExfilGuard policies configuration
#
# Policies define what traffic is allowed or denied. Each policy contains
# one or more rules that are evaluated in order.
#
# Recommended: Add your policies in /etc/exfilguard/policies.d/*.toml
# rather than editing this file, so package upgrades don't conflict.
#
# See https://laurikari.github.io/exfilguard/policies/ for full documentation.

# Default deny-all policy - blocks all traffic not explicitly allowed.
[[policy]]
name = "deny-all"
  [[policy.rule]]
  action = "DENY"
  status = 470
  reason = "Blocked by ExfilGuard"

# Example: Allow HTTPS to specific domains (uncomment to enable)
# [[policy]]
# name = "allow-example"
#   [[policy.rule]]
#   action = "ALLOW"
#   methods = ["GET", "POST"]
#   url_pattern = "https://api.example.com/**"
#
#   [[policy.rule]]
#   action = "ALLOW"
#   methods = ["CONNECT"]
#   url_pattern = "https://cdn.example.com/**"
#   inspect_payload = false  # Pass-through without TLS interception
